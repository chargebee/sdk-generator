/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.models.{{module}}.params;

import com.chargebee.v4.internal.Recommended;
import com.chargebee.v4.filters.StringFilter;
import com.chargebee.v4.filters.NumberFilter;
import com.chargebee.v4.filters.TimestampFilter;
import com.chargebee.v4.filters.EnumFilter;
import com.chargebee.v4.filters.BooleanFilter;
{{#if customFieldsSupported}}
import com.chargebee.v4.filters.CustomFieldSelector;
{{/if}}

import java.math.BigDecimal;
import java.sql.Timestamp;
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.List;
import java.util.function.Consumer;



public final class {{name}}Params {
{{>getParamsContent this}}

    {{#each subModels}}
    public static final class {{name}}Params {
{{>getParamsContent this}}
    }
    {{/each}}
}

{{#*inline "getParamsContent"}}
    private final Map<String, Object> queryParams;

    private {{name}}Params({{name}}Builder builder) {
        this.queryParams = Collections.unmodifiableMap(new LinkedHashMap<>(builder.queryParams));
    }

    /**
     * Get the query parameters for this request.
     */
    public Map<String, Object> toQueryParams() {
        return queryParams;
    }

    public {{name}}Builder toBuilder() {
        {{name}}Builder builder = new {{name}}Builder();
        builder.queryParams.putAll(queryParams);
        return builder;
    }

    /**
     * Create a new builder for {{name}}Params.
     */
    @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
    public static {{name}}Builder builder() {
        return new {{name}}Builder();
    }

    public static final class {{name}}Builder {
        private final Map<String, Object> queryParams = new LinkedHashMap<>();

        private {{../name}}Builder() {}

        {{#each fields~}}
        {{#if isFilter}}{{#if deprecated}}
        @Deprecated
{{/if}}        public {{filterType}} {{name}}() {
            return new {{filterType}}("{{curlName}}", this, queryParams);
        }
        {{else}}{{#if isSort}}{{#if deprecated}}
        @Deprecated
{{/if}}        public {{sortBuilderType}} {{name}}() {
            return new {{sortBuilderType}}("{{curlName}}", this);
        }
        {{else}}{{#if subModelField}}{{#if deprecated}}
        @Deprecated
{{/if}}        public {{../name}}Builder {{name}}({{subModelParamsType}} value) {
            queryParams.put("{{curlName}}", value);
            return this;
        }
        {{else}}{{#if deprecated}}
        @Deprecated
{{/if}}        public {{../name}}Builder {{name}}({{{type}}} value) {
            queryParams.put("{{curlName}}", value);
            return this;
        }
        {{/if}}{{/if}}{{/if}}
        {{/each}}

        {{#if customFieldsSupported}}
        /**
         * Create a filter for a custom field.
         * @param fieldName the custom field name (must contain "cf_")
         * @return CustomFieldSelector for choosing filter type
         */
        public CustomFieldSelector<{{name}}Builder> customField(String fieldName) {
            if (fieldName == null || !fieldName.contains("cf_")) {
                throw new IllegalArgumentException("Custom field name must contain 'cf_'");
            }
            return new CustomFieldSelector<>(fieldName, this, queryParams);
        }
        {{/if}}

        public {{name}}Params build() {
            return new {{name}}Params(this);
        }

        {{#each fields}}
        {{#if isFilter}}
        {{#if hasFilterEnum}}
        public static final class {{filterType}} extends EnumFilter<{{filterEnumType}}, {{../name}}Builder> {
            {{filterType}}(String fieldName, {{../name}}Builder builder, Map<String, Object> params) {
                super(fieldName, builder, params, {{filterEnumType}}::getValue);
            }

            /**
             * @deprecated This method accepting raw String will be removed in a future version.
             * Use the type-safe enum overload instead:
             * <pre>{@code .{{name}}().is({{filterEnumType}}.YOUR_VALUE)}</pre>
             * @see #is({{filterEnumType}})
             */
            @Deprecated
            public {{../name}}Builder is(String value) {
                params.put(fieldName + "[is]", value);
                return builder;
            }

            /**
             * @deprecated This method accepting raw String will be removed in a future version.
             * Use the type-safe enum overload instead:
             * <pre>{@code .{{name}}().isNot({{filterEnumType}}.YOUR_VALUE)}</pre>
             * @see #isNot({{filterEnumType}})
             */
            @Deprecated
            public {{../name}}Builder isNot(String value) {
                params.put(fieldName + "[is_not]", value);
                return builder;
            }

            /**
             * @deprecated This method accepting raw String will be removed in a future version.
             * Use the type-safe enum overload instead:
             * <pre>{@code .{{name}}().in({{filterEnumType}}.VALUE1, {{filterEnumType}}.VALUE2)}</pre>
             * @see #in({{filterEnumType}}[])
             */
            @Deprecated
            public {{../name}}Builder in(String... values) {
                params.put(fieldName + "[in]", "[" + String.join(",", values) + "]");
                return builder;
            }

            /**
             * @deprecated This method accepting raw String will be removed in a future version.
             * Use the type-safe enum overload instead:
             * <pre>{@code .{{name}}().notIn({{filterEnumType}}.VALUE1, {{filterEnumType}}.VALUE2)}</pre>
             * @see #notIn({{filterEnumType}}[])
             */
            @Deprecated
            public {{../name}}Builder notIn(String... values) {
                params.put(fieldName + "[not_in]", "[" + String.join(",", values) + "]");
                return builder;
            }
        }
        {{else if numberFilter}}
        public static final class {{filterType}} extends NumberFilter<{{../name}}Builder> {
            {{filterType}}(String fieldName, {{../name}}Builder builder, Map<String, Object> params) {
                super(fieldName, builder, params);
            }
        }
        {{else if timestampFilter}}
        public static final class {{filterType}} extends TimestampFilter<{{../name}}Builder> {
            {{filterType}}(String fieldName, {{../name}}Builder builder, Map<String, Object> params) {
                super(fieldName, builder, params);
            }
        }
        {{else if booleanFilter}}
        public static final class {{filterType}} extends BooleanFilter<{{../name}}Builder> {
            {{filterType}}(String fieldName, {{../name}}Builder builder, Map<String, Object> params) {
                super(fieldName, builder, params);
            }

            /**
             * @deprecated This method accepting raw String will be removed in a future version.
             * Use the type-safe boolean overload instead:
             * <pre>{@code .{{name}}().is(true)}</pre>
             * @see #is(boolean)
             */
            @Deprecated
            public {{../name}}Builder is(String value) {
                params.put(fieldName + "[is]", value);
                return builder;
            }
        }
        {{else}}
        public static final class {{filterType}} extends StringFilter<{{../name}}Builder> {
            {{filterType}}(String fieldName, {{../name}}Builder builder, Map<String, Object> params) {
                super(fieldName, builder, params);
            }
        }
        {{/if}}
        {{/if}}
        {{/each}}

        {{#each fields}}
        {{#if isSort}}
        public static final class {{sortBuilderType}} {
            private final String fieldName;
            private final {{../name}}Builder builder;

            {{sortBuilderType}}(String fieldName, {{../name}}Builder builder) {
                this.fieldName = fieldName;
                this.builder = builder;
            }

            {{#each sortableFields}}
            public SortDirection {{this}}() {
                return new SortDirection(fieldName, "{{this}}", builder);
            }
            {{/each}}
        }

        public static final class SortDirection {
            private final String fieldName;
            private final String selectedField;
            private final {{../name}}Builder builder;

            SortDirection(String fieldName, String selectedField, {{../name}}Builder builder) {
                this.fieldName = fieldName;
                this.selectedField = selectedField;
                this.builder = builder;
            }

            public {{../name}}Builder asc() {
                builder.queryParams.put(fieldName + "[asc]", selectedField);
                return builder;
            }

            public {{../name}}Builder desc() {
                builder.queryParams.put(fieldName + "[desc]", selectedField);
                return builder;
            }
        }
        {{/if}}
        {{/each}}
    }

    {{#each enumFields}}
    public enum {{name}} {
        {{#each values}}
        {{this.key}}("{{this.value}}"),
        {{/each}}
        /**
            * An enum member indicating that {{name}} was instantiated with an unknown
            * value.
            */
        _UNKNOWN(null);
        private final String value;

        {{name}}(String value) {
            this.value = value;
        }

        public String getValue() {
            return value;
        }

        public static {{name}} fromString(String value) {
            if (value == null) return _UNKNOWN;
            for ({{name}} enumValue : {{name}}.values()) {
                if (enumValue.value != null && enumValue.value.equals(value)) {
                    return enumValue;
                }
            }
            return _UNKNOWN;
        }
    }
    {{/each}}

    {{#each fields}}
    {{#if isFilter}}
    {{#if hasFilterEnum}}
    public enum {{filterEnumType}} {
        {{#each filterEnumFormatted}}
        {{this.key}}("{{this.value}}"),
        {{/each}}
        /**
            * An enum member indicating that {{filterEnumType}} was instantiated with an unknown
            * value.
            */
        _UNKNOWN(null);
        private final String value;

        {{filterEnumType}}(String value) {
            this.value = value;
        }

        public String getValue() {
            return value;
        }

        public static {{filterEnumType}} fromString(String value) {
            if (value == null) return _UNKNOWN;
            for ({{filterEnumType}} enumValue : {{filterEnumType}}.values()) {
                if (enumValue.value != null && enumValue.value.equals(value)) {
                    return enumValue;
                }
            }
            return _UNKNOWN;
        }
    }
    {{/if}}
    {{/if}}
    {{/each}}
{{/inline}}